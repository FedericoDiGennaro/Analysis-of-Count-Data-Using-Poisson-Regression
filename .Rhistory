# load packages -----------------------------------------------------------
library(ggplot2)
library(tidyverse)
library(GGally)
library(readxl)
library(MASS) # for BOXCOX
library(car) # for VIF
library(performance) # for nicer multicollinearity plot
# load data ---------------------------------------------------------------
rm(list = ls())
data <- read_excel("data/data.xlsx")
glimpse(data)
# define regressors
X <- data[-c(1,3)]
X$Direction <- as.factor(X$Direction)
# define dependent
y <- data[3]
# check presence of missing values
print(c('is there any missing value? ', any(is.na(data))))
# univariate numerical analysis for numeric variables
summary(X[-1])
# univariate numerical analysis for numeric variables
summary(X[-4])
var(X[-4])
# univariate numerical analysis for factor variable
# ratio of 1
mean(as.numeric(X$Direction)-1)
# univariate numerical analysis for numeric variables
summary(X)
var(X)
var(X[-4])
# for the graphical analysis look at the following pairs plot (AGGREGATE DATA)
ggpairs(X[-4])
# in order to check the differences in distribution due to difference in the
# union_shop variable, use this: (DISAGGREGATE DATA wrt Union_shop)
ggpairs(X[-4],
aes(color = X$Direction, alpha = .5),
lower = list(continuous = 'smooth'), legend = 1) +
theme(legend.position = "bottom", text = element_text(size = 14),
axis.text.x = element_text(size = 10), axis.text.y = element_text(size = 10) )
# for the graphical analysis look at the following pairs plot (AGGREGATE DATA)
par(mfrow=c(1,2))
ggpairs(X[-4])
# in order to check the differences in distribution due to difference in the
# union_shop variable, use this: (DISAGGREGATE DATA wrt Union_shop)
ggpairs(X[-4],
aes(color = X$Direction, alpha = .5),
lower = list(continuous = 'smooth'), legend = 1) +
theme(legend.position = "bottom", text = element_text(size = 14),
axis.text.x = element_text(size = 10), axis.text.y = element_text(size = 10) )
ggpairs(X)
# in order to check the differences in distribution due to difference in the
# union_shop variable, use this: (DISAGGREGATE DATA wrt Union_shop)
ggpairs(X[],
aes(color = X$Direction, alpha = .5),
lower = list(continuous = 'smooth'), legend = 1) +
theme(legend.position = "bottom", text = element_text(size = 14),
axis.text.x = element_text(size = 10), axis.text.y = element_text(size = 10) )
par(mfrow=c(3,1))
qqnorm(data$Distance, pch = 1, frame = FALSE, main = "Distance")
qqline(data$Distance, col = "steelblue", lwd = 2)
qqnorm(data$Population, pch = 1, frame = FALSE, main = "Population")
qqline(data$Population, col = "steelblue", lwd = 2)
par(mfrow=c(2,2))
qqnorm(data$Distance, pch = 1, frame = FALSE, main = "Distance")
qqline(data$Distance, col = "steelblue", lwd = 2)
qqnorm(data$Population, pch = 1, frame = FALSE, main = "Population")
qqline(data$Population, col = "steelblue", lwd = 2)
qqnorm(data$Degree_Urb, pch = 1, frame = FALSE, main = "Degree Urbanisation")
qqline(data$Degree_Urb, col = "steelblue", lwd = 2)
par(mfrow=c(1,1))
boxplot(X[-2], las = 2, col = c("red", "steelblue", "yellow"), ylab ="(%)")
